{% extends 'base.html' %}
{% load static %}
{% block title %} All Products {% endblock %} 

{% block content %}
    {% comment %} 📌 🛑 🔴 ❌ 😃 💯 ✌️{% endcomment %}
    <!-- Products -->
     
    <section class="all-products">
        <div class="container" style="margin-top: 22vh;">
            <!-- 1-Title -->
            <!-- <div class="fs-1 color-accent mb-4 title">
                وصل حديثا
            </div> -->
            <!-- 2- 📌Head-products-filter -->
            <div class="head-products d-flex justify-content-between align-items-center mb-3">
                <div class="Filters d-flex  align-items-center">
                    <div class="filter-item filter-one ms-2">
                        <label>العمر:</label>
                        <select id="ageFilter" class="form-select form-select-sm" aria-label="Small select example">
                            <option value="">لكل الأعمار </option>
                            {%for age_rang in age_ranges %}
                            <option value="{{age_rang.0}}">{{age_rang.1}}</option>
                            {%endfor%}
                        </select>
                    </div>
                    <div class="filter-item filter-tow ms-2">
                        <label>الجنس:</label>
                        <select id="genderFilter" class="form-select form-select-sm" aria-label="Small select example">
                            <option value="">الكل</option>
                            <option value="a">ولادي</option>
                            <option value="b">بناتي</option>
                        </select>
                    </div>
                    <div class="filter-item filter-three ms-2">
                        <label>النوع:</label>
                        <select id="typeFilter" class="form-select form-select-sm" aria-label="Small select example">
                            <option value="">الكل</option>
                            {% for category in categories %}
                            <option value="{{category.name}}">{{category.name}}</option>
                            {% endfor %}
                        </select>
                    </div>
                    <div class="filter-item filter-three ms-2">
                        <label>اللون:</label>
                        <select id="colorFilter" class="form-select form-select-sm" aria-label="Small select example">
                            <option value="">الكل</option>
                            {% for color in colors %}
                                <option value="{{ color.0 }}" style="background-color: {{ color.0 }};"> <span style="background-color: {{ color.0 }};">  </span>{{ color.1 }}</option>
                            {% endfor %}
                        </select>
                    </div>
                    <button id="resetFilters">إعادة التعيين</button>
                </div>
            </div>
            {% comment %} 🔴 {% endcomment %}
            <!-- 3- 📌products-->
            <div class="cards-products d-flex  flex-wrap">
                
                
                
                
                
                
                
                
                
                
                
                
                
                
                
                
                
                
                
                
                
                
                
                
                
                
                
                
                
                
                
                
                
                
                
                
                
                
                {% if products %}
                <!-- 🛑 -->
                {% for product in products %}
                    <div class="card product"  id="product-id" data-age="{{ product.product_age_range }}"  data-gender="{{ product.product_gender }}"  data-type="{{ product.product_subcategory.category.name }}"  data-color="{{ product.product_color }}">
                        {% comment %} ✌️Down {% endcomment %}
                        <div class="card-wishlist-cart"> 
                            <span class="wishlist">
                                <button class="add-remove-wishlist" data-product="{{ product.id }}">
                                    {% if product.id in wishlist_products %}
                                        <!-- Yes  -->
                                        <svg class="remove-wishlist"  width="33" height="33" viewBox="0 0 33 33" fill="none"
                                            xmlns="http://www.w3.org/2000/svg">
                                            <path
                                                d="M16.4725 26.255C16.2057 26.255 15.9413 26.2064 15.6791 26.1093C15.417 26.013 15.1864 25.865 14.9875 25.6652L13.409 24.242C10.9615 22.0191 8.80275 19.8572 6.93275 17.7562C5.06092 15.6561 4.125 13.473 4.125 11.207C4.125 9.45803 4.719 7.98953 5.907 6.80153C7.095 5.61353 8.5635 5.01953 10.3125 5.01953C11.3153 5.01953 12.3599 5.27299 13.4461 5.77991C14.5324 6.28682 15.5503 7.24291 16.5 8.64816C17.4506 7.24291 18.4685 6.28682 19.5539 5.77991C20.6392 5.27299 21.6837 5.01953 22.6875 5.01953C24.4365 5.01953 25.905 5.61353 27.093 6.80153C28.281 7.98953 28.875 9.45803 28.875 11.207C28.875 13.5253 27.901 15.7537 25.9531 17.8923C24.0052 20.0309 21.873 22.1493 19.5566 24.2475L17.9864 25.6652C17.7865 25.865 17.5514 26.013 17.281 26.1093C17.0106 26.2055 16.7415 26.2541 16.4739 26.255"
                                                fill="#47586E" />
                                        </svg>
                                        <!-- No  *-->
                                        <svg class="add-wishlist" style="display: none;" width="33" height="33" viewBox="0 0 33 33" fill="none"
                                            xmlns="http://www.w3.org/2000/svg">
                                            <path
                                                d="M16.4725 26.255C16.2057 26.255 15.9413 26.2064 15.6791 26.1093C15.417 26.013 15.1864 25.865 14.9875 25.6652L13.409 24.242C10.9615 22.0191 8.80275 19.8572 6.93275 17.7562C5.06092 15.6561 4.125 13.473 4.125 11.207C4.125 9.45803 4.719 7.98953 5.907 6.80153C7.095 5.61353 8.5635 5.01953 10.3125 5.01953C11.3153 5.01953 12.3599 5.27299 13.4461 5.77991C14.5324 6.28682 15.5503 7.24291 16.5 8.64816C17.4506 7.24291 18.4685 6.28682 19.5539 5.77991C20.6392 5.27299 21.6837 5.01953 22.6875 5.01953C24.4365 5.01953 25.905 5.61353 27.093 6.80153C28.281 7.98953 28.875 9.45803 28.875 11.207C28.875 13.5253 27.901 15.7537 25.9531 17.8923C24.0052 20.0309 21.873 22.1493 19.5566 24.2475L17.9864 25.6652C17.7865 25.865 17.5514 26.013 17.281 26.1093C17.0106 26.2055 16.7415 26.2541 16.4739 26.255M15.8276 10.0754C15.0045 8.74807 14.1488 7.80253 13.2605 7.23878C12.3723 6.67595 11.3896 6.39453 10.3125 6.39453C8.9375 6.39453 7.79167 6.85286 6.875 7.76953C5.95833 8.6862 5.5 9.83203 5.5 11.207C5.5 12.2227 5.78737 13.264 6.36212 14.331C6.93687 15.3989 7.70871 16.4925 8.67762 17.6118C9.64562 18.7301 10.7589 19.875 12.0175 21.0465C13.2742 22.2171 14.5832 23.4221 15.9445 24.6614C16.1031 24.8026 16.2883 24.8732 16.5 24.8732C16.7117 24.8732 16.8969 24.8026 17.0555 24.6614C18.4168 23.4221 19.7262 22.2167 20.9839 21.0452C22.2415 19.8755 23.3548 18.731 24.3238 17.6118C25.2918 16.4916 26.0631 15.398 26.6379 14.331C27.2126 13.264 27.5 12.2227 27.5 11.207C27.5 9.83203 27.0417 8.6862 26.125 7.76953C25.2083 6.85286 24.0625 6.39453 22.6875 6.39453C21.6104 6.39453 20.6277 6.67641 19.7395 7.24016C18.8503 7.80299 17.9946 8.74807 17.1724 10.0754C17.099 10.1992 17.001 10.2917 16.8781 10.3532C16.7553 10.4146 16.6292 10.4453 16.5 10.4453C16.3708 10.4453 16.2447 10.4146 16.1219 10.3532C15.999 10.2917 15.9014 10.1992 15.829 10.0754"
                                                fill="#47586E" />
                                        </svg>
                                    {% else %}
                                        <!-- Yes  *-->
                                        <svg class="remove-wishlist" style="display: none;"  width="33" height="33" viewBox="0 0 33 33" fill="none"
                                            xmlns="http://www.w3.org/2000/svg">
                                            <path
                                                d="M16.4725 26.255C16.2057 26.255 15.9413 26.2064 15.6791 26.1093C15.417 26.013 15.1864 25.865 14.9875 25.6652L13.409 24.242C10.9615 22.0191 8.80275 19.8572 6.93275 17.7562C5.06092 15.6561 4.125 13.473 4.125 11.207C4.125 9.45803 4.719 7.98953 5.907 6.80153C7.095 5.61353 8.5635 5.01953 10.3125 5.01953C11.3153 5.01953 12.3599 5.27299 13.4461 5.77991C14.5324 6.28682 15.5503 7.24291 16.5 8.64816C17.4506 7.24291 18.4685 6.28682 19.5539 5.77991C20.6392 5.27299 21.6837 5.01953 22.6875 5.01953C24.4365 5.01953 25.905 5.61353 27.093 6.80153C28.281 7.98953 28.875 9.45803 28.875 11.207C28.875 13.5253 27.901 15.7537 25.9531 17.8923C24.0052 20.0309 21.873 22.1493 19.5566 24.2475L17.9864 25.6652C17.7865 25.865 17.5514 26.013 17.281 26.1093C17.0106 26.2055 16.7415 26.2541 16.4739 26.255"
                                                fill="#47586E" />
                                        </svg>
                                        <!-- No  -->
                                        <svg class="add-wishlist" width="33" height="33" viewBox="0 0 33 33" fill="none"
                                            xmlns="http://www.w3.org/2000/svg">
                                            <path
                                                d="M16.4725 26.255C16.2057 26.255 15.9413 26.2064 15.6791 26.1093C15.417 26.013 15.1864 25.865 14.9875 25.6652L13.409 24.242C10.9615 22.0191 8.80275 19.8572 6.93275 17.7562C5.06092 15.6561 4.125 13.473 4.125 11.207C4.125 9.45803 4.719 7.98953 5.907 6.80153C7.095 5.61353 8.5635 5.01953 10.3125 5.01953C11.3153 5.01953 12.3599 5.27299 13.4461 5.77991C14.5324 6.28682 15.5503 7.24291 16.5 8.64816C17.4506 7.24291 18.4685 6.28682 19.5539 5.77991C20.6392 5.27299 21.6837 5.01953 22.6875 5.01953C24.4365 5.01953 25.905 5.61353 27.093 6.80153C28.281 7.98953 28.875 9.45803 28.875 11.207C28.875 13.5253 27.901 15.7537 25.9531 17.8923C24.0052 20.0309 21.873 22.1493 19.5566 24.2475L17.9864 25.6652C17.7865 25.865 17.5514 26.013 17.281 26.1093C17.0106 26.2055 16.7415 26.2541 16.4739 26.255M15.8276 10.0754C15.0045 8.74807 14.1488 7.80253 13.2605 7.23878C12.3723 6.67595 11.3896 6.39453 10.3125 6.39453C8.9375 6.39453 7.79167 6.85286 6.875 7.76953C5.95833 8.6862 5.5 9.83203 5.5 11.207C5.5 12.2227 5.78737 13.264 6.36212 14.331C6.93687 15.3989 7.70871 16.4925 8.67762 17.6118C9.64562 18.7301 10.7589 19.875 12.0175 21.0465C13.2742 22.2171 14.5832 23.4221 15.9445 24.6614C16.1031 24.8026 16.2883 24.8732 16.5 24.8732C16.7117 24.8732 16.8969 24.8026 17.0555 24.6614C18.4168 23.4221 19.7262 22.2167 20.9839 21.0452C22.2415 19.8755 23.3548 18.731 24.3238 17.6118C25.2918 16.4916 26.0631 15.398 26.6379 14.331C27.2126 13.264 27.5 12.2227 27.5 11.207C27.5 9.83203 27.0417 8.6862 26.125 7.76953C25.2083 6.85286 24.0625 6.39453 22.6875 6.39453C21.6104 6.39453 20.6277 6.67641 19.7395 7.24016C18.8503 7.80299 17.9946 8.74807 17.1724 10.0754C17.099 10.1992 17.001 10.2917 16.8781 10.3532C16.7553 10.4146 16.6292 10.4453 16.5 10.4453C16.3708 10.4453 16.2447 10.4146 16.1219 10.3532C15.999 10.2917 15.9014 10.1992 15.829 10.0754"
                                                fill="#47586E" />
                                        </svg>
                                    {% endif %}
                                </button>
                            </span>
                            <span class="cart">
                                <button  class="add-remove-cartItem" data-product="{{ product.id }}">
                                    {% if product.id in cart_items %}
                                        <!-- Yes -->
                                        <svg class="remove-cart"  width="30" height="30" viewBox="0 0 30 30" fill="none"
                                            xmlns="http://www.w3.org/2000/svg">
                                            <path fill-rule="evenodd" clip-rule="evenodd"
                                                d="M10.5226 4.0625C10.8726 3.325 11.6276 2.8125 12.5001 2.8125H17.5001C18.3726 2.8125 19.1264 3.325 19.4776 4.0625C20.3314 4.07 20.9976 4.10875 21.5926 4.34125C22.3029 4.61909 22.9206 5.09127 23.3751 5.70375C23.8339 6.32125 24.0501 7.1125 24.3451 8.20125L25.2726 11.6037L25.6226 12.655L25.6526 12.6925C26.7789 14.135 26.2426 16.28 25.1701 20.5687C24.4876 23.2975 24.1476 24.6612 23.1301 25.4562C22.1126 26.25 20.7064 26.25 17.8939 26.25H12.1064C9.29385 26.25 7.8876 26.25 6.8701 25.4562C5.8526 24.6612 5.51135 23.2975 4.8301 20.5687C3.7576 16.28 3.22135 14.135 4.3476 12.6925L4.3776 12.655L4.7276 11.6037L5.6551 8.20125C5.95135 7.1125 6.1676 6.32 6.6251 5.7025C7.07976 5.09048 7.69747 4.61875 8.4076 4.34125C9.0026 4.10875 9.6676 4.06875 10.5226 4.0625ZM10.5251 5.94125C9.6976 5.95 9.3651 5.98125 9.0901 6.08875C8.70756 6.23835 8.37487 6.49264 8.1301 6.8225C7.9101 7.11875 7.7801 7.5325 7.4176 8.86625L6.7051 11.4775C7.9801 11.25 9.7226 11.25 12.1051 11.25H17.8939C20.2776 11.25 22.0189 11.25 23.2939 11.475L22.5826 8.86375C22.2201 7.53 22.0901 7.11625 21.8701 6.82C21.6253 6.49014 21.2926 6.23585 20.9101 6.08625C20.6351 5.97875 20.3026 5.9475 19.4751 5.93875C19.2976 6.31231 19.0179 6.6279 18.6683 6.84892C18.3187 7.06995 17.9137 7.18734 17.5001 7.1875H12.5001C12.0867 7.18746 11.6817 7.07024 11.3321 6.84945C10.9826 6.62866 10.7028 6.31458 10.5251 5.94125Z"
                                                fill="#2B4254" />
                                        </svg>
                                        <!-- No -->
                                        <svg class="add-cart" style="display: none;" width="30" height="30" viewBox="0 0 30 30" fill="none"
                                            xmlns="http://www.w3.org/2000/svg">
                                            <path
                                                d="M4.8301 20.5687C3.7576 16.2788 3.22135 14.135 4.3476 12.6925C5.47385 11.25 7.6851 11.25 12.1064 11.25H17.8939C22.3164 11.25 24.5264 11.25 25.6526 12.6925C26.7789 14.135 26.2426 16.28 25.1701 20.5687C24.4876 23.2975 24.1476 24.6612 23.1301 25.4562C22.1126 26.25 20.7064 26.25 17.8939 26.25H12.1064C9.29385 26.25 7.8876 26.25 6.8701 25.4562C5.8526 24.6612 5.51135 23.2975 4.8301 20.5687Z"
                                                stroke="#2B4254" stroke-width="1.875" />
                                            <path opacity="0.5"
                                                d="M24.375 11.875L23.4875 8.61875C23.145 7.3625 22.9737 6.735 22.6225 6.26125C22.2723 5.79058 21.7966 5.428 21.25 5.215C20.7 5 20.05 5 18.75 5M5.625 11.875L6.5125 8.61875C6.855 7.3625 7.02625 6.735 7.3775 6.26125C7.72772 5.79058 8.20336 5.428 8.75 5.215C9.3 5 9.95 5 11.25 5"
                                                stroke="#2B4254" stroke-width="1.875" />
                                            <path
                                                d="M11.25 5C11.25 4.66848 11.3817 4.35054 11.6161 4.11612C11.8505 3.8817 12.1685 3.75 12.5 3.75H17.5C17.8315 3.75 18.1495 3.8817 18.3839 4.11612C18.6183 4.35054 18.75 4.66848 18.75 5C18.75 5.33152 18.6183 5.64946 18.3839 5.88388C18.1495 6.1183 17.8315 6.25 17.5 6.25H12.5C12.1685 6.25 11.8505 6.1183 11.6161 5.88388C11.3817 5.64946 11.25 5.33152 11.25 5Z"
                                                stroke="#2B4254" stroke-width="1.875" />
                                        </svg>



                                        
                                    {% else %}
                                        <!-- No -->
                                        <svg class="add-cart"  width="30" height="30" viewBox="0 0 30 30" fill="none"
                                            xmlns="http://www.w3.org/2000/svg">
                                            <path
                                                d="M4.8301 20.5687C3.7576 16.2788 3.22135 14.135 4.3476 12.6925C5.47385 11.25 7.6851 11.25 12.1064 11.25H17.8939C22.3164 11.25 24.5264 11.25 25.6526 12.6925C26.7789 14.135 26.2426 16.28 25.1701 20.5687C24.4876 23.2975 24.1476 24.6612 23.1301 25.4562C22.1126 26.25 20.7064 26.25 17.8939 26.25H12.1064C9.29385 26.25 7.8876 26.25 6.8701 25.4562C5.8526 24.6612 5.51135 23.2975 4.8301 20.5687Z"
                                                stroke="#2B4254" stroke-width="1.875" />
                                            <path opacity="0.5"
                                                d="M24.375 11.875L23.4875 8.61875C23.145 7.3625 22.9737 6.735 22.6225 6.26125C22.2723 5.79058 21.7966 5.428 21.25 5.215C20.7 5 20.05 5 18.75 5M5.625 11.875L6.5125 8.61875C6.855 7.3625 7.02625 6.735 7.3775 6.26125C7.72772 5.79058 8.20336 5.428 8.75 5.215C9.3 5 9.95 5 11.25 5"
                                                stroke="#2B4254" stroke-width="1.875" />
                                            <path
                                                d="M11.25 5C11.25 4.66848 11.3817 4.35054 11.6161 4.11612C11.8505 3.8817 12.1685 3.75 12.5 3.75H17.5C17.8315 3.75 18.1495 3.8817 18.3839 4.11612C18.6183 4.35054 18.75 4.66848 18.75 5C18.75 5.33152 18.6183 5.64946 18.3839 5.88388C18.1495 6.1183 17.8315 6.25 17.5 6.25H12.5C12.1685 6.25 11.8505 6.1183 11.6161 5.88388C11.3817 5.64946 11.25 5.33152 11.25 5Z"
                                                stroke="#2B4254" stroke-width="1.875" />
                                        </svg>
                                        <!-- Yes -->
                                        <svg class="remove-cart" style="display: none;" width="30" height="30" viewBox="0 0 30 30" fill="none"
                                            xmlns="http://www.w3.org/2000/svg">
                                            <path fill-rule="evenodd" clip-rule="evenodd"
                                                d="M10.5226 4.0625C10.8726 3.325 11.6276 2.8125 12.5001 2.8125H17.5001C18.3726 2.8125 19.1264 3.325 19.4776 4.0625C20.3314 4.07 20.9976 4.10875 21.5926 4.34125C22.3029 4.61909 22.9206 5.09127 23.3751 5.70375C23.8339 6.32125 24.0501 7.1125 24.3451 8.20125L25.2726 11.6037L25.6226 12.655L25.6526 12.6925C26.7789 14.135 26.2426 16.28 25.1701 20.5687C24.4876 23.2975 24.1476 24.6612 23.1301 25.4562C22.1126 26.25 20.7064 26.25 17.8939 26.25H12.1064C9.29385 26.25 7.8876 26.25 6.8701 25.4562C5.8526 24.6612 5.51135 23.2975 4.8301 20.5687C3.7576 16.28 3.22135 14.135 4.3476 12.6925L4.3776 12.655L4.7276 11.6037L5.6551 8.20125C5.95135 7.1125 6.1676 6.32 6.6251 5.7025C7.07976 5.09048 7.69747 4.61875 8.4076 4.34125C9.0026 4.10875 9.6676 4.06875 10.5226 4.0625ZM10.5251 5.94125C9.6976 5.95 9.3651 5.98125 9.0901 6.08875C8.70756 6.23835 8.37487 6.49264 8.1301 6.8225C7.9101 7.11875 7.7801 7.5325 7.4176 8.86625L6.7051 11.4775C7.9801 11.25 9.7226 11.25 12.1051 11.25H17.8939C20.2776 11.25 22.0189 11.25 23.2939 11.475L22.5826 8.86375C22.2201 7.53 22.0901 7.11625 21.8701 6.82C21.6253 6.49014 21.2926 6.23585 20.9101 6.08625C20.6351 5.97875 20.3026 5.9475 19.4751 5.93875C19.2976 6.31231 19.0179 6.6279 18.6683 6.84892C18.3187 7.06995 17.9137 7.18734 17.5001 7.1875H12.5001C12.0867 7.18746 11.6817 7.07024 11.3321 6.84945C10.9826 6.62866 10.7028 6.31458 10.5251 5.94125Z"
                                                fill="#2B4254" />
                                        </svg>
                                        
                                    {% endif %}
                                    

                                </button>
                            </span>
                        </div>
                        {% comment %} ✌️Up {% endcomment %}
                        <a href="{% url 'Product_Detail' product.id %}">
                            <img src="{{ product.product_image.url }}" class="card-img-top" alt="...">
                        </a>
                        <div class="card-body">
                            {% comment %} ❌Down {% endcomment %}
                            <span class="card-rate d-flex align-items-center ">
                                <span class="number-rate">
                                    {{ product.avg_rating|floatformat:1|default:"0" }}
                                </span>
                                <span class="card-star">
                                    <div class="star-container">
                                        <span class="star empty" data-value="1">&#9734;</span>
                                        <span class="star empty" data-value="2">&#9734;</span>
                                        <span class="star empty" data-value="3">&#9734;</span>
                                        <span class="star empty" data-value="4">&#9734;</span>
                                        <span class="star empty" data-value="5">&#9734;</span>
                                    </div>
                                </span>
                            </span>
                            {% comment %} ❌Up {% endcomment %}

                            <h5 class="card-title">
                                {{product.product_name}}
                            </h5>
                            <h5 class="card-title">
                                {{product.product_selling_price}}
                                ر.ي
                            </h5>
                        </div>
                    </div>
                {% endfor %}
                <!-- 🛑 -->
                {% else %}
                <p class="text-center text-danger color-accent text-center">لا توجد منتجات مطابقة للبحث.</p>
                <a class="btn-primary-tow w-100 " href="{% url 'Products_List' %}"> استمر بالتسوق </a>
                {% endif %}











            









                
            </div>
            {% comment %} 🔴 {% endcomment %}
            {% if products %}
                {% if request.resolver_match.url_name == 'Products_List' %} 
                <span id="btnHide" class="btn-primary-tow-span btn-hide">
                    {% comment %} <a class="btn-primary-tow" href="#"> </a> {% endcomment %}
                    <button class="btn-primary-tow  text-center" id="loadmoreBtn"> تحميل المزيد  </button>
                </span>
                {% endif %}
            {% endif %}
            <!-- 4 -->
            
        </div>
    </section>
    {% if products %}
        <h1 id="noProducts" class="display-none fs-1 color-accent text-center"> لا يوجد منتجات</h1>
    {% else %}
    {% comment %} <a class="btn-primary-tow " href="{% url 'Products_List' %}"> استمر بالتسوق </a> {% endcomment %}
    {% endif %}
    
{% endblock %}
{% block javascript %}
    <script>
        {% comment %} ******** {% endcomment %}
        $(document).ready(function () {
            console.log('all product')
            {% comment %} url = "single_cartItem_ar" {% endcomment %}
            // Rate:
            
            rate();

            // Load more Products
            {% comment %} $("#loadmoreBtn").on('click',function(){
                var _currentResult=$(".product").length;
                $.ajax({
                    url:"{% url 'load_more' %}",
                    type:'post',
                    data:{
                        'offset':_currentResult,
                        'csrfmiddlewaretoken':"{{csrf_token}}"
                    },
                    dataType:'json',
                    beforeSend:function(){
                        $("#loadmoreBtn").addClass('disabled').text('تحميل..');
                    },
                    success: function(res) {
                        console.log(res)
                        var _html = '';
                        var json_data = res.Products;                         
                        $.each(json_data, function(index, data) {
                            var imageUrl = data.product_image; 
                    
                                _html += '<div class="card product" id="product-id" ' +
                                'data-age="' + data.product_age_range + '" ' +
                                'data-gender="' + data.product_gender + '" ' +
                                'data-color="' + data.product_color + '">' +
                                '<img src="' + imageUrl + '" class="card-img-top" alt="Image not found">' +
                                '<h5 class="card-title">' + data.product_name + '</h5>' +
                                '<h5 class="card-title">' + data.product_selling_price + ' ر.ي</h5>' +
                            '</div>';
                        });
                    
                        $(".cards-products").append(_html);
                        var _countTotal=$(".product").length;
                        if(_countTotal==res.totalResult){
                            $("#loadmoreBtn").text(' انتهت المنتجات ');
                        }else{
                            $("#loadmoreBtn").text(' تحميل المزيد');
                        }
                    } 
                })
            }) {% endcomment %}
            rate();

            $("#loadmoreBtn").on('click',function(){
                var _currentResult=$(".product").length;
                $.ajax({
                    url:"{% url 'load_more' %}",
                    type:'post',
                    data:{
                        'offset':_currentResult,
                        'csrfmiddlewaretoken':"{{csrf_token}}"
                    },
                    dataType:'json',
                    beforeSend:function(){
                        $("#loadmoreBtn").addClass('disabled').text('تحميل..');
                    },
                    success: function(res) {
                        console.log(res)
                        var _html = '';
                        var json_data = res.Products;                         
                        $.each(json_data, function(index, data) {
                            var imageUrl = data.product_image;  // سيحتوي على المسار الكامل
                    
                            



                            _html += `
                            <div class="card product"  id="product-id" data-age="${data.product_age_range}"  data-gender="${data.product_gender}"  data-type="${data.product_category}"  data-color="${data.product_color}">
                                {% comment %} ✌️Down {% endcomment %}
                                <div class="card-wishlist-cart"> 
                                    <span class="wishlist">
                                        <button class="add-remove-wishlist" data-product="${data.product_id}">
                                            


                                            ${data.in_wishlist ? `
                                            <!-- Yes  -->
                                                <svg class="remove-wishlist"  width="33" height="33" viewBox="0 0 33 33" fill="none"
                                                    xmlns="http://www.w3.org/2000/svg">
                                                    <path
                                                        d="M16.4725 26.255C16.2057 26.255 15.9413 26.2064 15.6791 26.1093C15.417 26.013 15.1864 25.865 14.9875 25.6652L13.409 24.242C10.9615 22.0191 8.80275 19.8572 6.93275 17.7562C5.06092 15.6561 4.125 13.473 4.125 11.207C4.125 9.45803 4.719 7.98953 5.907 6.80153C7.095 5.61353 8.5635 5.01953 10.3125 5.01953C11.3153 5.01953 12.3599 5.27299 13.4461 5.77991C14.5324 6.28682 15.5503 7.24291 16.5 8.64816C17.4506 7.24291 18.4685 6.28682 19.5539 5.77991C20.6392 5.27299 21.6837 5.01953 22.6875 5.01953C24.4365 5.01953 25.905 5.61353 27.093 6.80153C28.281 7.98953 28.875 9.45803 28.875 11.207C28.875 13.5253 27.901 15.7537 25.9531 17.8923C24.0052 20.0309 21.873 22.1493 19.5566 24.2475L17.9864 25.6652C17.7865 25.865 17.5514 26.013 17.281 26.1093C17.0106 26.2055 16.7415 26.2541 16.4739 26.255"
                                                        fill="#47586E" />
                                                </svg>
                                                <!-- No  *-->
                                                <svg class="add-wishlist" style="display: none;" width="33" height="33" viewBox="0 0 33 33" fill="none"
                                                    xmlns="http://www.w3.org/2000/svg">
                                                    <path
                                                        d="M16.4725 26.255C16.2057 26.255 15.9413 26.2064 15.6791 26.1093C15.417 26.013 15.1864 25.865 14.9875 25.6652L13.409 24.242C10.9615 22.0191 8.80275 19.8572 6.93275 17.7562C5.06092 15.6561 4.125 13.473 4.125 11.207C4.125 9.45803 4.719 7.98953 5.907 6.80153C7.095 5.61353 8.5635 5.01953 10.3125 5.01953C11.3153 5.01953 12.3599 5.27299 13.4461 5.77991C14.5324 6.28682 15.5503 7.24291 16.5 8.64816C17.4506 7.24291 18.4685 6.28682 19.5539 5.77991C20.6392 5.27299 21.6837 5.01953 22.6875 5.01953C24.4365 5.01953 25.905 5.61353 27.093 6.80153C28.281 7.98953 28.875 9.45803 28.875 11.207C28.875 13.5253 27.901 15.7537 25.9531 17.8923C24.0052 20.0309 21.873 22.1493 19.5566 24.2475L17.9864 25.6652C17.7865 25.865 17.5514 26.013 17.281 26.1093C17.0106 26.2055 16.7415 26.2541 16.4739 26.255M15.8276 10.0754C15.0045 8.74807 14.1488 7.80253 13.2605 7.23878C12.3723 6.67595 11.3896 6.39453 10.3125 6.39453C8.9375 6.39453 7.79167 6.85286 6.875 7.76953C5.95833 8.6862 5.5 9.83203 5.5 11.207C5.5 12.2227 5.78737 13.264 6.36212 14.331C6.93687 15.3989 7.70871 16.4925 8.67762 17.6118C9.64562 18.7301 10.7589 19.875 12.0175 21.0465C13.2742 22.2171 14.5832 23.4221 15.9445 24.6614C16.1031 24.8026 16.2883 24.8732 16.5 24.8732C16.7117 24.8732 16.8969 24.8026 17.0555 24.6614C18.4168 23.4221 19.7262 22.2167 20.9839 21.0452C22.2415 19.8755 23.3548 18.731 24.3238 17.6118C25.2918 16.4916 26.0631 15.398 26.6379 14.331C27.2126 13.264 27.5 12.2227 27.5 11.207C27.5 9.83203 27.0417 8.6862 26.125 7.76953C25.2083 6.85286 24.0625 6.39453 22.6875 6.39453C21.6104 6.39453 20.6277 6.67641 19.7395 7.24016C18.8503 7.80299 17.9946 8.74807 17.1724 10.0754C17.099 10.1992 17.001 10.2917 16.8781 10.3532C16.7553 10.4146 16.6292 10.4453 16.5 10.4453C16.3708 10.4453 16.2447 10.4146 16.1219 10.3532C15.999 10.2917 15.9014 10.1992 15.829 10.0754"
                                                        fill="#47586E" />
                                                </svg>` : `
                                            <!-- Yes  *-->
                                                <svg class="remove-wishlist" style="display: none;"  width="33" height="33" viewBox="0 0 33 33" fill="none"
                                                    xmlns="http://www.w3.org/2000/svg">
                                                    <path
                                                        d="M16.4725 26.255C16.2057 26.255 15.9413 26.2064 15.6791 26.1093C15.417 26.013 15.1864 25.865 14.9875 25.6652L13.409 24.242C10.9615 22.0191 8.80275 19.8572 6.93275 17.7562C5.06092 15.6561 4.125 13.473 4.125 11.207C4.125 9.45803 4.719 7.98953 5.907 6.80153C7.095 5.61353 8.5635 5.01953 10.3125 5.01953C11.3153 5.01953 12.3599 5.27299 13.4461 5.77991C14.5324 6.28682 15.5503 7.24291 16.5 8.64816C17.4506 7.24291 18.4685 6.28682 19.5539 5.77991C20.6392 5.27299 21.6837 5.01953 22.6875 5.01953C24.4365 5.01953 25.905 5.61353 27.093 6.80153C28.281 7.98953 28.875 9.45803 28.875 11.207C28.875 13.5253 27.901 15.7537 25.9531 17.8923C24.0052 20.0309 21.873 22.1493 19.5566 24.2475L17.9864 25.6652C17.7865 25.865 17.5514 26.013 17.281 26.1093C17.0106 26.2055 16.7415 26.2541 16.4739 26.255"
                                                        fill="#47586E" />
                                                </svg>
                                                <!-- No  -->
                                                <svg class="add-wishlist" width="33" height="33" viewBox="0 0 33 33" fill="none"
                                                    xmlns="http://www.w3.org/2000/svg">
                                                    <path
                                                        d="M16.4725 26.255C16.2057 26.255 15.9413 26.2064 15.6791 26.1093C15.417 26.013 15.1864 25.865 14.9875 25.6652L13.409 24.242C10.9615 22.0191 8.80275 19.8572 6.93275 17.7562C5.06092 15.6561 4.125 13.473 4.125 11.207C4.125 9.45803 4.719 7.98953 5.907 6.80153C7.095 5.61353 8.5635 5.01953 10.3125 5.01953C11.3153 5.01953 12.3599 5.27299 13.4461 5.77991C14.5324 6.28682 15.5503 7.24291 16.5 8.64816C17.4506 7.24291 18.4685 6.28682 19.5539 5.77991C20.6392 5.27299 21.6837 5.01953 22.6875 5.01953C24.4365 5.01953 25.905 5.61353 27.093 6.80153C28.281 7.98953 28.875 9.45803 28.875 11.207C28.875 13.5253 27.901 15.7537 25.9531 17.8923C24.0052 20.0309 21.873 22.1493 19.5566 24.2475L17.9864 25.6652C17.7865 25.865 17.5514 26.013 17.281 26.1093C17.0106 26.2055 16.7415 26.2541 16.4739 26.255M15.8276 10.0754C15.0045 8.74807 14.1488 7.80253 13.2605 7.23878C12.3723 6.67595 11.3896 6.39453 10.3125 6.39453C8.9375 6.39453 7.79167 6.85286 6.875 7.76953C5.95833 8.6862 5.5 9.83203 5.5 11.207C5.5 12.2227 5.78737 13.264 6.36212 14.331C6.93687 15.3989 7.70871 16.4925 8.67762 17.6118C9.64562 18.7301 10.7589 19.875 12.0175 21.0465C13.2742 22.2171 14.5832 23.4221 15.9445 24.6614C16.1031 24.8026 16.2883 24.8732 16.5 24.8732C16.7117 24.8732 16.8969 24.8026 17.0555 24.6614C18.4168 23.4221 19.7262 22.2167 20.9839 21.0452C22.2415 19.8755 23.3548 18.731 24.3238 17.6118C25.2918 16.4916 26.0631 15.398 26.6379 14.331C27.2126 13.264 27.5 12.2227 27.5 11.207C27.5 9.83203 27.0417 8.6862 26.125 7.76953C25.2083 6.85286 24.0625 6.39453 22.6875 6.39453C21.6104 6.39453 20.6277 6.67641 19.7395 7.24016C18.8503 7.80299 17.9946 8.74807 17.1724 10.0754C17.099 10.1992 17.001 10.2917 16.8781 10.3532C16.7553 10.4146 16.6292 10.4453 16.5 10.4453C16.3708 10.4453 16.2447 10.4146 16.1219 10.3532C15.999 10.2917 15.9014 10.1992 15.829 10.0754"
                                                        fill="#47586E" />
                                                </svg>`}
                                        </button>
                                    </span>
                                    <span class="cart">
                                        <button  class="add-remove-cartItem" data-product="${data.product_id}">
                                            {% if product.id in cart_items %}
                                                <!-- Yes -->
                                                <svg class="remove-cart"  width="30" height="30" viewBox="0 0 30 30" fill="none"
                                                    xmlns="http://www.w3.org/2000/svg">
                                                    <path fill-rule="evenodd" clip-rule="evenodd"
                                                        d="M10.5226 4.0625C10.8726 3.325 11.6276 2.8125 12.5001 2.8125H17.5001C18.3726 2.8125 19.1264 3.325 19.4776 4.0625C20.3314 4.07 20.9976 4.10875 21.5926 4.34125C22.3029 4.61909 22.9206 5.09127 23.3751 5.70375C23.8339 6.32125 24.0501 7.1125 24.3451 8.20125L25.2726 11.6037L25.6226 12.655L25.6526 12.6925C26.7789 14.135 26.2426 16.28 25.1701 20.5687C24.4876 23.2975 24.1476 24.6612 23.1301 25.4562C22.1126 26.25 20.7064 26.25 17.8939 26.25H12.1064C9.29385 26.25 7.8876 26.25 6.8701 25.4562C5.8526 24.6612 5.51135 23.2975 4.8301 20.5687C3.7576 16.28 3.22135 14.135 4.3476 12.6925L4.3776 12.655L4.7276 11.6037L5.6551 8.20125C5.95135 7.1125 6.1676 6.32 6.6251 5.7025C7.07976 5.09048 7.69747 4.61875 8.4076 4.34125C9.0026 4.10875 9.6676 4.06875 10.5226 4.0625ZM10.5251 5.94125C9.6976 5.95 9.3651 5.98125 9.0901 6.08875C8.70756 6.23835 8.37487 6.49264 8.1301 6.8225C7.9101 7.11875 7.7801 7.5325 7.4176 8.86625L6.7051 11.4775C7.9801 11.25 9.7226 11.25 12.1051 11.25H17.8939C20.2776 11.25 22.0189 11.25 23.2939 11.475L22.5826 8.86375C22.2201 7.53 22.0901 7.11625 21.8701 6.82C21.6253 6.49014 21.2926 6.23585 20.9101 6.08625C20.6351 5.97875 20.3026 5.9475 19.4751 5.93875C19.2976 6.31231 19.0179 6.6279 18.6683 6.84892C18.3187 7.06995 17.9137 7.18734 17.5001 7.1875H12.5001C12.0867 7.18746 11.6817 7.07024 11.3321 6.84945C10.9826 6.62866 10.7028 6.31458 10.5251 5.94125Z"
                                                        fill="#2B4254" />
                                                </svg>
                                                <!-- No -->
                                                <svg class="add-cart" style="display: none;" width="30" height="30" viewBox="0 0 30 30" fill="none"
                                                    xmlns="http://www.w3.org/2000/svg">
                                                    <path
                                                        d="M4.8301 20.5687C3.7576 16.2788 3.22135 14.135 4.3476 12.6925C5.47385 11.25 7.6851 11.25 12.1064 11.25H17.8939C22.3164 11.25 24.5264 11.25 25.6526 12.6925C26.7789 14.135 26.2426 16.28 25.1701 20.5687C24.4876 23.2975 24.1476 24.6612 23.1301 25.4562C22.1126 26.25 20.7064 26.25 17.8939 26.25H12.1064C9.29385 26.25 7.8876 26.25 6.8701 25.4562C5.8526 24.6612 5.51135 23.2975 4.8301 20.5687Z"
                                                        stroke="#2B4254" stroke-width="1.875" />
                                                    <path opacity="0.5"
                                                        d="M24.375 11.875L23.4875 8.61875C23.145 7.3625 22.9737 6.735 22.6225 6.26125C22.2723 5.79058 21.7966 5.428 21.25 5.215C20.7 5 20.05 5 18.75 5M5.625 11.875L6.5125 8.61875C6.855 7.3625 7.02625 6.735 7.3775 6.26125C7.72772 5.79058 8.20336 5.428 8.75 5.215C9.3 5 9.95 5 11.25 5"
                                                        stroke="#2B4254" stroke-width="1.875" />
                                                    <path
                                                        d="M11.25 5C11.25 4.66848 11.3817 4.35054 11.6161 4.11612C11.8505 3.8817 12.1685 3.75 12.5 3.75H17.5C17.8315 3.75 18.1495 3.8817 18.3839 4.11612C18.6183 4.35054 18.75 4.66848 18.75 5C18.75 5.33152 18.6183 5.64946 18.3839 5.88388C18.1495 6.1183 17.8315 6.25 17.5 6.25H12.5C12.1685 6.25 11.8505 6.1183 11.6161 5.88388C11.3817 5.64946 11.25 5.33152 11.25 5Z"
                                                        stroke="#2B4254" stroke-width="1.875" />
                                                </svg>



                                                
                                            {% else %}
                                                <!-- No -->
                                                <svg class="add-cart"  width="30" height="30" viewBox="0 0 30 30" fill="none"
                                                    xmlns="http://www.w3.org/2000/svg">
                                                    <path
                                                        d="M4.8301 20.5687C3.7576 16.2788 3.22135 14.135 4.3476 12.6925C5.47385 11.25 7.6851 11.25 12.1064 11.25H17.8939C22.3164 11.25 24.5264 11.25 25.6526 12.6925C26.7789 14.135 26.2426 16.28 25.1701 20.5687C24.4876 23.2975 24.1476 24.6612 23.1301 25.4562C22.1126 26.25 20.7064 26.25 17.8939 26.25H12.1064C9.29385 26.25 7.8876 26.25 6.8701 25.4562C5.8526 24.6612 5.51135 23.2975 4.8301 20.5687Z"
                                                        stroke="#2B4254" stroke-width="1.875" />
                                                    <path opacity="0.5"
                                                        d="M24.375 11.875L23.4875 8.61875C23.145 7.3625 22.9737 6.735 22.6225 6.26125C22.2723 5.79058 21.7966 5.428 21.25 5.215C20.7 5 20.05 5 18.75 5M5.625 11.875L6.5125 8.61875C6.855 7.3625 7.02625 6.735 7.3775 6.26125C7.72772 5.79058 8.20336 5.428 8.75 5.215C9.3 5 9.95 5 11.25 5"
                                                        stroke="#2B4254" stroke-width="1.875" />
                                                    <path
                                                        d="M11.25 5C11.25 4.66848 11.3817 4.35054 11.6161 4.11612C11.8505 3.8817 12.1685 3.75 12.5 3.75H17.5C17.8315 3.75 18.1495 3.8817 18.3839 4.11612C18.6183 4.35054 18.75 4.66848 18.75 5C18.75 5.33152 18.6183 5.64946 18.3839 5.88388C18.1495 6.1183 17.8315 6.25 17.5 6.25H12.5C12.1685 6.25 11.8505 6.1183 11.6161 5.88388C11.3817 5.64946 11.25 5.33152 11.25 5Z"
                                                        stroke="#2B4254" stroke-width="1.875" />
                                                </svg>
                                                <!-- Yes -->
                                                <svg class="remove-cart" style="display: none;" width="30" height="30" viewBox="0 0 30 30" fill="none"
                                                    xmlns="http://www.w3.org/2000/svg">
                                                    <path fill-rule="evenodd" clip-rule="evenodd"
                                                        d="M10.5226 4.0625C10.8726 3.325 11.6276 2.8125 12.5001 2.8125H17.5001C18.3726 2.8125 19.1264 3.325 19.4776 4.0625C20.3314 4.07 20.9976 4.10875 21.5926 4.34125C22.3029 4.61909 22.9206 5.09127 23.3751 5.70375C23.8339 6.32125 24.0501 7.1125 24.3451 8.20125L25.2726 11.6037L25.6226 12.655L25.6526 12.6925C26.7789 14.135 26.2426 16.28 25.1701 20.5687C24.4876 23.2975 24.1476 24.6612 23.1301 25.4562C22.1126 26.25 20.7064 26.25 17.8939 26.25H12.1064C9.29385 26.25 7.8876 26.25 6.8701 25.4562C5.8526 24.6612 5.51135 23.2975 4.8301 20.5687C3.7576 16.28 3.22135 14.135 4.3476 12.6925L4.3776 12.655L4.7276 11.6037L5.6551 8.20125C5.95135 7.1125 6.1676 6.32 6.6251 5.7025C7.07976 5.09048 7.69747 4.61875 8.4076 4.34125C9.0026 4.10875 9.6676 4.06875 10.5226 4.0625ZM10.5251 5.94125C9.6976 5.95 9.3651 5.98125 9.0901 6.08875C8.70756 6.23835 8.37487 6.49264 8.1301 6.8225C7.9101 7.11875 7.7801 7.5325 7.4176 8.86625L6.7051 11.4775C7.9801 11.25 9.7226 11.25 12.1051 11.25H17.8939C20.2776 11.25 22.0189 11.25 23.2939 11.475L22.5826 8.86375C22.2201 7.53 22.0901 7.11625 21.8701 6.82C21.6253 6.49014 21.2926 6.23585 20.9101 6.08625C20.6351 5.97875 20.3026 5.9475 19.4751 5.93875C19.2976 6.31231 19.0179 6.6279 18.6683 6.84892C18.3187 7.06995 17.9137 7.18734 17.5001 7.1875H12.5001C12.0867 7.18746 11.6817 7.07024 11.3321 6.84945C10.9826 6.62866 10.7028 6.31458 10.5251 5.94125Z"
                                                        fill="#2B4254" />
                                                </svg>
                                                
                                            {% endif %}
                                            

                                        </button>
                                    </span>
                                </div>
                                {% comment %} ✌️Up {% endcomment %}
                                <a href="/product/products/${data.product_id}/">
                                    <img src="${data.product_image}" class="card-img-top" alt="...">
                                </a>
                                <div class="card-body">
                                    {% comment %} ❌Down {% endcomment %}
                                    <span class="card-rate d-flex align-items-center ">
                                        <span class="number-rate">
                                            ${data.avg_rating.toFixed(1)}
                                        </span>
                                        <span class="card-star">
                                            <div class="star-container">
                                                <span class="star empty" data-value="1">&#9734;</span>
                                                <span class="star empty" data-value="2">&#9734;</span>
                                                <span class="star empty" data-value="3">&#9734;</span>
                                                <span class="star empty" data-value="4">&#9734;</span>
                                                <span class="star empty" data-value="5">&#9734;</span>
                                            </div>
                                        </span>
                                    </span>
                                    {% comment %} ❌Up {% endcomment %}

                                    <h5 class="card-title">
                                        ${data.product_name}
                                    </h5>
                                    <h5 class="card-title">
                                            ${data.product_selling_price}
                                        ر.ي
                                    </h5>
                                </div>
                            </div>
                            `;
                        });
                        $(".cards-products").append(_html);
                        rate();
                        var _countTotal=$(".product").length;
                        if(_countTotal==res.totalResult){
                            $("#loadmoreBtn").text(' انتهت المنتجات ');
                        }else{
                            $("#loadmoreBtn").text(' تحميل المزيد');
                        }
                    } 
                })
            })
            {% comment %} imp {% endcomment %}
            

            // Filter Products
            function filterProducts() {
                let age = $('#ageFilter').val();
                let gender = $('#genderFilter').val();
                let type = $('#typeFilter').val();
                let color = $('#colorFilter').val();
    
                let visibleProducts = 0;
                $('.product').each(function () {
                    let productAge = $(this).data('age');
                    let productGender = $(this).data('gender');
                    let productType = $(this).data('type');
                    let productColor = $(this).data('color');
    
                    let show = true;
                    if (age && productAge !== age) show = false;
                    if (gender && productGender !== gender) show = false;
                    if (type && productType !== type) show = false;
                    if (color && productColor !== color) show = false;
    
                    $(this).toggle(show);
                    if (show) visibleProducts++;
                });
    
                $('#noProducts').toggle(visibleProducts === 0);
                $('#btnHide').toggle(visibleProducts !== 0);
            }
            $('#ageFilter, #genderFilter, #typeFilter, #colorFilter').change(filterProducts);
            $('#resetFilters').click(function () {
                $('#ageFilter, #genderFilter, #typeFilter, #colorFilter').val('');
                $('.product').show();
                $('#noProducts').hide();
                $('#btnHide').show();
            });


            


            

            {% comment %} end  Products {% endcomment %}

        });
    </script>
{% endblock %}

